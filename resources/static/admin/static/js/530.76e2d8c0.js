"use strict";(self["webpackChunkvue3_bootstrap"]=self["webpackChunkvue3_bootstrap"]||[]).push([[530],{8530:function(e,a,l){l.r(a),l.d(a,{default:function(){return C}});var t=l(6252),i=l(3577),r=l(2262),s=l(9963),o=l(1348),u=l(3378),n=l(4277),d=l(6391),c=l(8735),p=l(9150),g=l(4537),m=l(2201),v=l(6921),f=l.n(v);const y={class:"container"},_={class:"left"},w={class:"edit-size",style:{border:"1px solid #ccc","margin-top":"15px"}},b={id:"vditor"},h={class:"right"},k=(0,t._)("hr",null,null,-1),V={class:"form"},z={key:0},W={key:1},U={class:"btns"};var x=(0,t.aZ)({__name:"update",setup(e){const a=(0,r.qj)({vditorLoading:!1,isDisabled:!1,saveLoading:!1}),l=(0,r.iH)(),v=(e,a,t)=>{if(""===a)t(new Error(P("tips.rules.checkTitle")));else{if(""!==E.title){if(!l.value)return;l.value.validateField("checkPass",(()=>null))}t()}},x=(e,a,t)=>{if(""===a)t(new Error(P("tips.rules.checkDescription")));else{if(""!==E.description){if(!l.value)return;l.value.validateField("checkPass",(()=>null))}t()}},L=(e,a,t)=>{if(""===a)t(new Error(P("tips.rules.checkCategory")));else{if(""!==E.category){if(!l.value)return;l.value.validateField("checkPass",(()=>null))}t()}},C=(0,r.qj)({title:[{required:!0,validator:v,trigger:"blur"}],description:[{required:!0,validator:x,trigger:"blur"}],category:[{required:!0,validator:L,trigger:"change"}]}),{t:P}=(0,p.QT)(),S={author_name:P("article.Parameters.author_name"),title:P("article.Parameters.title"),description:P("article.Parameters.description"),tags:P("article.Parameters.tags"),category:P("article.Parameters.category")},D=(0,r.iH)("top"),H=n.z.get("userInfo"),j=(0,r.iH)(),q=()=>{j.value=new(f())("vditor",{height:650,mode:"sv",toolbarConfig:{pin:!0},cache:{enable:!1},after:()=>{j.value.setValue("······内容正在加载中······")}})},E=(0,r.qj)({author_name:H.name,title:"",description:"",category:""}),Z=e=>{const a=[];a[0]=String(E.category);const l={article_id:R.query.article_id,author_name:E.author_name,title:E.title,description:E.description,content:j.value.getValue(),tags:JSON.stringify(F.value),category:JSON.stringify(a),keyword:"",next:"",prev:"",status:e};return l},A=(0,d.S)(),N=e=>{e&&e.validate(((e,l)=>{if(e){const e=Z(0);a.saveLoading=!0,A.updataArticle(e).then((e=>{"2000"===e.code&&((0,o.z8)({type:"success",message:"更新成功"}),a.saveLoading=!1,g.Z.push("/articles"))})).catch((e=>{a.saveLoading=!1,(0,o.z8)({type:"warning",message:e.message})}))}}))},O=(0,r.iH)(""),F=(0,r.iH)([""]),J=(0,r.iH)(!1),K=(0,r.iH)(),$=()=>{J.value=!0,(0,t.Y3)((()=>{K.value.input.focus()}))},B=e=>{F.value.splice(F.value.indexOf(e),1)},T=()=>{O.value&&(""===F.value[0]?F.value[0]=O.value:F.value.push(O.value)),J.value=!1,O.value=""},Y=(0,c.e)(),I=(0,r.iH)(),Q=()=>{const e={user_id:H.user_id};Y.getCategoryListALL(e).then((e=>{"2000"===e.code&&(I.value=e.data)})).catch((e=>{(0,o.z8)({type:"warning",message:e.message})}))},R=(0,m.yj)(),G=()=>{const e={article_id:R.query.article_id};a.vditorLoading=!0,a.isDisabled=!0,A.getArticle(e).then((e=>{"2000"===e.code&&(j.value.setValue(e.data.Content),E.title=e.data.title,E.description=e.data.description,e.data.category&&(E.category=JSON.parse(e.data.category)),F.value=JSON.parse(e.data.tags)),a.vditorLoading=!1,a.isDisabled=!1})).catch((e=>{(0,o.z8)({type:"warning",message:e.message})}))};return(0,t.bv)((()=>{G(),Q(),q()})),(e,o)=>{const n=(0,t.up)("el-text"),d=(0,t.up)("el-page-header"),c=(0,t.up)("el-form-item"),p=(0,t.up)("el-tag"),g=(0,t.up)("el-button"),m=(0,t.up)("el-option"),v=(0,t.up)("el-select"),f=(0,t.up)("el-form"),x=(0,t.up)("el-card"),L=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.j4)(x,null,{default:(0,t.w5)((()=>[(0,t._)("div",y,[(0,t._)("div",_,[(0,t.Wm)(d,{onBack:o[0]||(o[0]=a=>e.$router.push("/articles"))},{content:(0,t.w5)((()=>[(0,t.Wm)(n,{class:"mx-1",size:"large"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.$t("article.addArticleContent")),1)])),_:1})])),_:1}),(0,t._)("div",w,[(0,t.wy)((0,t._)("div",b,null,512),[[L,a.vditorLoading]])])]),(0,t._)("div",h,[(0,t.Wm)(n,{class:"mx-1",size:"large"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.$t("article.addArticleParameters")),1)])),_:1}),k,(0,t._)("div",V,[(0,t.Wm)(f,{ref_key:"ruleFormRef",ref:l,rules:C,"label-position":D.value,"label-width":"100px",model:E,style:{"max-width":"460px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{label:S.author_name},{default:(0,t.w5)((()=>[(0,t.Wm)((0,r.SU)(u.EZ),{modelValue:E.author_name,"onUpdate:modelValue":o[1]||(o[1]=e=>E.author_name=e),disabled:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,t.Wm)(c,{label:S.title,prop:"title"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,r.SU)(u.EZ),{modelValue:E.title,"onUpdate:modelValue":o[2]||(o[2]=e=>E.title=e),placeholder:"Please input 标题",clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,t.Wm)(c,{label:S.description,prop:"description"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,r.SU)(u.EZ),{modelValue:E.description,"onUpdate:modelValue":o[3]||(o[3]=e=>E.description=e),placeholder:"Please input 摘要",clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,t.Wm)(c,{label:S.tags},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(F.value,(e=>((0,t.wg)(),(0,t.j4)(p,{key:e,class:"mx-1",closable:"","disable-transitions":!1,onClose:a=>B(e),style:{"margin-top":"5px"}},{default:(0,t.w5)((()=>[""===e?((0,t.wg)(),(0,t.iD)("span",z," null ")):((0,t.wg)(),(0,t.iD)("span",W,(0,i.zw)(e),1))])),_:2},1032,["onClose"])))),128)),J.value?((0,t.wg)(),(0,t.j4)((0,r.SU)(u.EZ),{key:0,ref_key:"InputRef",ref:K,modelValue:O.value,"onUpdate:modelValue":o[4]||(o[4]=e=>O.value=e),class:"ml-1 w-20",size:"small",onKeyup:(0,s.D2)(T,["enter"]),onBlur:T},null,8,["modelValue","onKeyup"])):((0,t.wg)(),(0,t.j4)(g,{key:1,class:"button-new-tag ml-1",size:"small",onClick:$},{default:(0,t.w5)((()=>[(0,t.Uk)(" + New Tag ")])),_:1}))])),_:1},8,["label"]),(0,t.Wm)(c,{label:S.category,prop:"category"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{modelValue:E.category,"onUpdate:modelValue":o[5]||(o[5]=e=>E.category=e),class:"m-2",placeholder:"Select"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(I.value,(e=>((0,t.wg)(),(0,t.j4)(m,{key:e.category_id,label:e.category_name,value:e.category_name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["rules","label-position","model"])]),(0,t._)("div",U,[(0,t.Wm)(g,{type:"primary",style:{float:"right"},onClick:o[6]||(o[6]=e=>N(l.value)),disabled:a.isDisabled,loading:a.saveLoading},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.$t("Btns.save")),1)])),_:1},8,["disabled","loading"])])])])])),_:1})}}});const L=x;var C=L}}]);