"use strict";(self["webpackChunkvue3_bootstrap"]=self["webpackChunkvue3_bootstrap"]||[]).push([[423],{9423:function(e,l,a){a.r(l),a.d(l,{default:function(){return C}});var t=a(6252),r=a(3577),i=a(2262),o=a(9963),s=a(1348),u=a(3378),n=a(4277),d=a(6391),c=a(8735),p=a(9150),m=a(4537),g=a(6921),v=a.n(g);const f={class:"container"},w={class:"left"},y={class:"edit-size",style:{border:"1px solid #ccc","margin-top":"15px"}},_=(0,t._)("div",{id:"vditor"},null,-1),h=[_],b={class:"right"},k=(0,t._)("hr",null,null,-1),V={class:"form"},z={key:0},W={key:1},x={class:"btns"};var U=(0,t.aZ)({__name:"add",setup(e){const l=(0,i.qj)({vditorLoading:!1,saveLoading:!1}),a=(0,i.iH)(),g=(e,l,t)=>{if(""===l)t(new Error(C("tips.rules.checkTitle")));else{if(""!==E.title){if(!a.value)return;a.value.validateField("checkPass",(()=>null))}t()}},_=(e,l,t)=>{if(""===l)t(new Error(C("tips.rules.checkDescription")));else{if(""!==E.description){if(!a.value)return;a.value.validateField("checkPass",(()=>null))}t()}},U=(e,l,t)=>{if(""===l)t(new Error(C("tips.rules.checkCategory")));else{if(""!==E.category){if(!a.value)return;a.value.validateField("checkPass",(()=>null))}t()}},P=(0,i.qj)({title:[{required:!0,validator:g,trigger:"blur"}],description:[{required:!0,validator:_,trigger:"blur"}],category:[{required:!0,validator:U,trigger:"change"}]}),{t:C}=(0,p.QT)(),H={author_name:C("article.Parameters.author_name"),title:C("article.Parameters.title"),description:C("article.Parameters.description"),tags:C("article.Parameters.tags"),category:C("article.Parameters.category")},j=(0,i.iH)("top"),L=n.z.get("userInfo"),S=(0,i.iH)(),D=()=>{S.value=new(v())("vditor",{height:650,mode:"sv",placeholder:"请输入内容...",toolbarConfig:{pin:!0},cache:{enable:!1},after:()=>{}})},E=(0,i.qj)({author_name:L.name,title:"",description:"",category:""}),q=e=>{const l=[];l[0]=E.category;const a={author_id:L.user_id,author_name:E.author_name,title:E.title,description:E.description,content:S.value.getValue(),tags:JSON.stringify(K.value),category:JSON.stringify(l),keyword:"",next:"",prev:"",status:e};return a},Z=(0,d.S)(),A=async e=>{e&&await e.validate(((e,a)=>{if(e){const e=q(0);l.saveLoading=!0,Z.addArticle(e).then((e=>{"2000"===e.code&&((0,s.z8)({type:"success",message:"保存成功"}),m.Z.push("/articles"))})).catch((e=>{(0,s.z8)({type:"warning",message:e.message})}))}else console.log("error submit!",a)}))},F=(0,i.iH)(""),K=(0,i.iH)([""]),$=(0,i.iH)(!1),B=(0,i.iH)(),N=()=>{$.value=!0,(0,t.Y3)((()=>{B.value.input.focus()}))},O=e=>{K.value.splice(K.value.indexOf(e),1)},T=()=>{F.value&&(""===K.value[0]?K.value[0]=F.value:K.value.push(F.value)),$.value=!1,F.value=""},Y=(0,c.e)(),I=(0,i.iH)(),J=()=>{const e={user_id:L.user_id};Y.getCategoryListALL(e).then((e=>{"2000"===e.code&&(I.value=e.data)})).catch((e=>{(0,s.z8)({type:"warning",message:e.message})}))};return(0,t.bv)((()=>{J(),D()})),(e,s)=>{const n=(0,t.up)("el-text"),d=(0,t.up)("el-page-header"),c=(0,t.up)("el-form-item"),p=(0,t.up)("el-tag"),m=(0,t.up)("el-button"),g=(0,t.up)("el-option"),v=(0,t.up)("el-select"),_=(0,t.up)("el-form"),U=(0,t.up)("el-card"),C=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.j4)(U,null,{default:(0,t.w5)((()=>[(0,t._)("div",f,[(0,t._)("div",w,[(0,t.Wm)(d,{onBack:s[0]||(s[0]=l=>e.$router.push("/articles"))},{content:(0,t.w5)((()=>[(0,t.Wm)(n,{class:"mx-1",size:"large"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.$t("article.addArticleContent")),1)])),_:1})])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",y,h)),[[C,l.vditorLoading]])]),(0,t._)("div",b,[(0,t.Wm)(n,{class:"mx-1",size:"large"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.$t("article.addArticleParameters")),1)])),_:1}),k,(0,t._)("div",V,[(0,t.Wm)(_,{ref_key:"ruleFormRef",ref:a,rules:P,"label-position":j.value,"label-width":"100px",model:E,style:{"max-width":"460px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{label:H.author_name},{default:(0,t.w5)((()=>[(0,t.Wm)((0,i.SU)(u.EZ),{modelValue:E.author_name,"onUpdate:modelValue":s[1]||(s[1]=e=>E.author_name=e),disabled:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,t.Wm)(c,{label:H.title,prop:"title"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,i.SU)(u.EZ),{modelValue:E.title,"onUpdate:modelValue":s[2]||(s[2]=e=>E.title=e),placeholder:"Please input blog title",clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,t.Wm)(c,{label:H.description,prop:"description"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,i.SU)(u.EZ),{modelValue:E.description,"onUpdate:modelValue":s[3]||(s[3]=e=>E.description=e),placeholder:"Please input summary",autosize:"",type:"textarea",clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),(0,t.Wm)(c,{label:H.tags},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(K.value,(e=>((0,t.wg)(),(0,t.j4)(p,{key:e,class:"mx-1",closable:"","disable-transitions":!1,onClose:l=>O(e),style:{"margin-top":"5px"}},{default:(0,t.w5)((()=>[""===e?((0,t.wg)(),(0,t.iD)("span",z," null ")):((0,t.wg)(),(0,t.iD)("span",W,(0,r.zw)(e),1))])),_:2},1032,["onClose"])))),128)),$.value?((0,t.wg)(),(0,t.j4)((0,i.SU)(u.EZ),{key:0,ref_key:"InputRef",ref:B,modelValue:F.value,"onUpdate:modelValue":s[4]||(s[4]=e=>F.value=e),class:"ml-1 w-20",size:"small",onKeyup:(0,o.D2)(T,["enter"]),onBlur:T},null,8,["modelValue","onKeyup"])):((0,t.wg)(),(0,t.j4)(m,{key:1,class:"button-new-tag ml-1",size:"small",onClick:N},{default:(0,t.w5)((()=>[(0,t.Uk)(" + New Tag ")])),_:1}))])),_:1},8,["label"]),(0,t.Wm)(c,{label:H.category,prop:"category"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{modelValue:E.category,"onUpdate:modelValue":s[5]||(s[5]=e=>E.category=e),class:"m-2",placeholder:"Select"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(I.value,(e=>((0,t.wg)(),(0,t.j4)(g,{key:e.category_id,label:e.category_name,value:e.category_name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["rules","label-position","model"])]),(0,t._)("div",x,[(0,t.Wm)(m,{type:"primary",style:{float:"right"},onClick:s[6]||(s[6]=e=>A(a.value)),loading:l.saveLoading},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.$t("Btns.save")),1)])),_:1},8,["loading"])])])])])),_:1})}}});const P=U;var C=P}}]);